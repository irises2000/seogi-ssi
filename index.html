<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.1.0/papaparse.min.js"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/quiple/hbios-sys@latest/hbios-sys.css"
    />
    <title>seogi</title>
  </head>
  <body>
      <div class="date-list" id="date-list"></div>
      <div class="content-box" id="content-box">
        <p id="content-text" style="display: none;"></p>
      </div>
  
    <script>
      var public_spreadsheet_url =
        "https://docs.google.com/spreadsheets/d/13kWyDNR5larvdzYubROyb9KlqocmFr1_mxDmWAWbqHA/gviz/tq?tqx=out:csv";
  
      function init() {
        Papa.parse(public_spreadsheet_url, {
          download: true,
          header: true,
          complete: showInfo,
        });
      }
  
      window.addEventListener("DOMContentLoaded", init);
  
      function showInfo(results) {
        var data = results.data;
        var dataLength = data.length;
  
        // 좌측에 날짜 나열
        var dateList = document.getElementById("date-list");
        var contentBox = document.getElementById("content-box");
        var contentText = document.getElementById("content-text");
  
        var currentVisibleId = null; // 현재 보이는 content를 추적
  
        for (var i = 0; i < dataLength; i++) {
          var dateDiv = document.createElement("div");
          dateDiv.className = "date";
          dateDiv.id = `date-${i}`;
          dateDiv.textContent = data[i].date;
  
          dateDiv.addEventListener("click", function (event) {
            var clickedId = event.target.id.split("-")[1];
  
            // 모든 날짜에서 'active' 클래스 제거
          var allDates = document.querySelectorAll(".date");
          allDates.forEach(function (date) {
            date.classList.remove("active");
          });

          // 같은 날짜를 클릭해도 'active' 제거, 내용 숨김
          if (currentVisibleId === clickedId) {
            contentText.style.display = "none";
            currentVisibleId = null;
          } else {
            // 클릭한 날짜에 'active' 클래스 추가
            event.target.classList.add("active");

              var contentWithLineBreaks = data[clickedId].content.replace(
                /(?:\r\n|\r|\n)/g,
                "<br>"
              );

              var content = data[clickedId].content || ""; // content가 없을 경우 빈 문자열 처리
              
              var contentWithHighlights = content.replace(
                /𖤫/g,
                '<span class="no-blur">𖤫</span>'
              );

              contentText.innerHTML = contentWithLineBreaks;
              contentText.innerHTML = contentWithHighlights;
              contentText.style.display = "block";
              currentVisibleId = clickedId;
            }
          });
  
          dateList.appendChild(dateDiv);
        }
      }
    </script>

      <div id="menu">
        <ul class="menulist">
          <li>
            <a href="https://en.wikipedia.org/wiki/Iris_(plant)" target="_blank"
              >6: 384:1b, Britannica.</a
            >
          </li>
          <li>
            <a
              href="https://lionaire.notion.site/133b9ed57d8e80ae9228d041ead64f8a?pvs=4"
              target="_blank"
              >디자이너 백과사전</a
            >
          </li>
          <li><a href="archive.html" target="_blank">letter</a></li>
        </ul>
      </div>
    </div>
  </body>
</html>
